databaseChangeLog:
  - changeSet:
      id: 1
      author: Fabian Iwanecki
      changes:
        - sql:
            comment: enable extension uuid
            sql: CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
        - createTable:
            tableName: games
            columns:
              - column:
                  name: id
                  type: varchar
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_games
              - column:
                  name: patch_version
                  type: varchar
              - column:
                  name: date
                  type: timestamp with time zone
              - column:
                  name: queue_type
                  type: varchar
              - column:
                  name: ending_wave
                  type: number
              - column:
                  name: game_length
                  type: number
              - column:
                  name: game_elo
                  type: number
              - column:
                  name: player_count
                  type: number
              - column:
                  name: spell_choices
                  type: varchar[]
              - column:
                  name: left_king_percent_hp
                  type: float[]
              - column:
                  name: right_king_percent_hp
                  type: float[]
              - column:
                  name: king_spell
                  type: varchar
        - createTable:
            tableName: games_player_data
            columns:
              - column:
                  name: uuid
                  type: uuid
                  defaultValueComputed: uuid_generate_v4()
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_player_data
              - column:
                  name: game_id
                  type: varchar
                  constraints:
                    foreignKeyName: fk_player_data_games
                    referencedTableName: games
                    referencedColumnNames: id
              - column:
                  name: player_id
                  type: varchar
              - column:
                  name: player_name
                  type: varchar
              - column:
                  name: player_slot
                  type: number
              - column:
                  name: legion
                  type: varchar
              - column:
                  name: workers
                  type: number
              - column:
                  name: value
                  type: number
              - column:
                  name: is_cross
                  type: boolean
              - column:
                  name: game_result
                  type: varchar
              - column:
                  name: overall_elo
                  type: number
              - column:
                  name: fighters
                  type: varchar[]
              - column:
                  name: mercenaries
                  type: varchar[]
              - column:
                  name: stayed_until_end
                  type: boolean
              - column:
                  name: chosen_spell
                  type: varchar
              - column:
                  name: chosen_spell_location_x
                  type: varchar
              - column:
                  name: chosen_spell_location_y
                  type: varchar
              - column:
                  name: party_size
                  type: number
              - column:
                  name: first_wave_fighters
                  type: varchar[]
              - column:
                  name: rolls
                  type: varchar[]
              - column:
                  name: legion_specific_elo
                  type: number
              - column:
                  name: party_members
                  type: varchar[]
              - column:
                  name: party_members_ids
                  type: varchar[]
              - column:
                  name: mvp_score
                  type: number
              - column:
                  name: net_worth_per_wave
                  type: integer[]
              - column:
                  name: workers_per_wave
                  type: integer[]
              - column:
                  name: income_per_wave
                  type: integer[]
              - column:
                  name: mercenaries_sent_per_wave
                  type: jsonb
              - column:
                  name: mercenaries_received_per_wave
                  type: jsonb
              - column:
                  name: leaks_per_wave
                  type: jsonb
              - column:
                  name: build_per_wave
                  type: jsonb
              - column:
                  name: leak_value
                  type: number
              - column:
                  name: leaks_caught_value
                  type: number
              - column:
                  name: left_at_seconds
                  type: number
              - column:
                  name: king_upgrades_per_wave
                  type: jsonb
              - column:
                  name: opponent_king_upgrades_per_wave
                  type: jsonb
  - changeSet:
      id: 2
      author: Fabian Iwanecki
      changes:
        - createTable:
            tableName: units
            columns:
              - column:
                  name: id
                  type: varchar
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_units
              - column:
                  name: unit_id
                  type: varchar
              - column:
                  name: name
                  type: varchar
              - column:
                  name: cost
                  type: number
              - column:
                  name: enabled
                  type: boolean
              - column:
                  name: icon_path
                  type: varchar
  - changeSet:
      id: 3
      author: Fabian Iwanecki
      changes:
        - createTable:
            tableName: statistics
            columns:
              - column:
                  name: uuid
                  type: uuid
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_statistics
              - column:
                  name: patch
                  type: varchar
              - column:
                  name: create_ts
                  type: timestamp
              - column:
                  name: modified_ts
                  type: timestamp
        - createTable:
            tableName: statistics_ending_waves
            columns:
              - column:
                  name: uuid
                  type: uuid
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_statistics_ending_waves
              - column:
                  name: ending_wave
                  type: varchar
              - column:
                  name: games_ended
                  type: number
              - column:
                  name: games_total
                  type: number
              - column:
                  name: patch
                  type: varchar
              - column:
                  name: game_type
                  type: varchar
              - column:
                  name: rank
                  type: varchar
              - column:
                  name: statistics_uuid
                  type: uuid
                  constraints:
                    references: statistics(uuid)
                    foreignKeyName: fk_statistics_ending_waves
              - column:
                  name: create_ts
                  type: timestamp
              - column:
                  name: modified_ts
                  type: timestamp
        - createTable:
            tableName: statistics_legions
            columns:
              - column:
                  name: uuid
                  type: uuid
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_statistics_legions
              - column:
                  name: legion
                  type: varchar
              - column:
                  name: games_ended
                  type: number
              - column:
                  name: games_total
                  type: number
              - column:
                  name: patch
                  type: varchar
              - column:
                  name: game_type
                  type: varchar
              - column:
                  name: rank
                  type: varchar
              - column:
                  name: statistics_uuid
                  type: uuid
                  constraints:
                    references: statistics(uuid)
                    foreignKeyName: fk_statistics_legions
              - column:
                  name: create_ts
                  type: timestamp
              - column:
                  name: modified_ts
                  type: timestamp
        - createTable:
            tableName: statistics_spells
            columns:
              - column:
                  name: uuid
                  type: uuid
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_statistics_spells
              - column:
                  name: spell
                  type: varchar
              - column:
                  name: games_ended
                  type: number
              - column:
                  name: games_total
                  type: number
              - column:
                  name: patch
                  type: varchar
              - column:
                  name: game_type
                  type: varchar
              - column:
                  name: rank
                  type: varchar
              - column:
                  name: statistics_uuid
                  type: uuid
                  constraints:
                    references: statistics(uuid)
                    foreignKeyName: fk_statistics_spells
              - column:
                  name: create_ts
                  type: timestamp
              - column:
                  name: modified_ts
                  type: timestamp
        - createTable:
            tableName: statistics_rolls
            columns:
              - column:
                  name: uuid
                  type: uuid
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_statistics_rolls
              - column:
                  name: roll
                  type: varchar
              - column:
                  name: games_ended
                  type: number
              - column:
                  name: games_total
                  type: number
              - column:
                  name: patch
                  type: varchar
              - column:
                  name: game_type
                  type: varchar
              - column:
                  name: rank
                  type: varchar
              - column:
                  name: statistics_uuid
                  type: uuid
                  constraints:
                    references: statistics(uuid)
                    foreignKeyName: fk_statistics_rolls
              - column:
                  name: create_ts
                  type: timestamp
              - column:
                  name: modified_ts
                  type: timestamp
        - createTable:
            tableName: statistics_first_wave_fighters
            columns:
              - column:
                  name: uuid
                  type: uuid
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_statistics_first_wave_fighters
              - column:
                  name: fighters
                  type: varchar[]
              - column:
                  name: games_ended
                  type: number
              - column:
                  name: games_total
                  type: number
              - column:
                  name: patch
                  type: varchar
              - column:
                  name: game_type
                  type: varchar
              - column:
                  name: rank
                  type: varchar
              - column:
                  name: statistics_uuid
                  type: uuid
                  constraints:
                    references: statistics(uuid)
                    foreignKeyName: fk_statistics_first_wave_fighters
              - column:
                  name: create_ts
                  type: timestamp
              - column:
                  name: modified_ts
                  type: timestamp
        - createTable:
            tableName: statistics_units
            columns:
              - column:
                  name: uuid
                  type: uuid
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_statistics_units
              - column:
                  name: unit
                  type: varchar
              - column:
                  name: games_ended
                  type: number
              - column:
                  name: games_total
                  type: number
              - column:
                  name: patch
                  type: varchar
              - column:
                  name: game_type
                  type: varchar
              - column:
                  name: rank
                  type: varchar
              - column:
                  name: statistics_uuid
                  type: uuid
                  constraints:
                    references: statistics(uuid)
                    foreignKeyName: fk_statistics_units
              - column:
                  name: create_ts
                  type: timestamp
              - column:
                  name: modified_ts
                  type: timestamp
  - changeSet:
      id: 4
      author: Fabian Iwanecki
      changes:
        - createTable:
            tableName: patches
            columns:
              - column:
                  name: patch
                  type: varchar
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_patches
              - column:
                  name: create_ts
                  type: timestamp
              - column:
                  name: modified_ts
                  type: timestamp
